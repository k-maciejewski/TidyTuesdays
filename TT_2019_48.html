<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Tidy Tuesday 2019 week 48</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.5/datatables.js"></script>
<link href="site_libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Files
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="2019w43/TT_2019_w43.html">2019 week 43</a>
    </li>
    <li>
      <a href="TT_2019_44.html">2019 week 44</a>
    </li>
    <li>
      <a href="TT_2019_45.html">2019 week 45</a>
    </li>
    <li>
      <a href="TT_2019_48.html">2019 week 48</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/k-maciejewski/TidyTuesdays/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Tidy Tuesday 2019 week 48</h1>

</div>


<p>This week’s data is from the <a href="https://studentaid.ed.gov/sa/about/data-center/student/default">Department of Education</a> courtesy of <a href="https://twitter.com/AllbriteAllday">Alex Albright</a>.</p>
<p>Data idea comes from <a href="https://www.dignityanddebt.org/projects/student-debt-racial-disparities/">Dignity and Debt</a> who is running a <a href="https://docs.google.com/forms/d/e/1FAIpQLSckHpk5xJwqW0_sIEnCs-tScxttMV5WVqGjP0Ws8bD0x_LZHA/viewform">contest</a> around data viz for understanding and spreading awareness around Student Loan debt.</p>
<pre class="r"><code>loans &lt;- readr::read_csv(&quot;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-11-26/loans.csv&quot;)</code></pre>
<p><strong>Data Dictionary</strong></p>
<p>Provided by <a href="https://github.com/rfordatascience/tidytuesday/tree/master/data/2019/2019-11-26">Tidy Tuesday</a></p>
<table>
<colgroup>
<col width="21%" />
<col width="11%" />
<col width="66%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">variable</th>
<th align="left">class</th>
<th align="left">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">agency_name</td>
<td align="left">character</td>
<td align="left">Name of loan agency</td>
</tr>
<tr class="even">
<td align="left">year</td>
<td align="left">integer</td>
<td align="left">two digits year</td>
</tr>
<tr class="odd">
<td align="left">quarter</td>
<td align="left">integer</td>
<td align="left">Quarter (3 month period)</td>
</tr>
<tr class="even">
<td align="left">starting</td>
<td align="left">double</td>
<td align="left">Inventory, Total value in dollars at start of quarter</td>
</tr>
<tr class="odd">
<td align="left">added</td>
<td align="left">double</td>
<td align="left">Inventory, Total value added during quarter</td>
</tr>
<tr class="even">
<td align="left">total</td>
<td align="left">double</td>
<td align="left">Recoveries, Total dollars repaid</td>
</tr>
<tr class="odd">
<td align="left">consolidation</td>
<td align="left">double</td>
<td align="left">Recoveries, Consolidation reflects the dollar value of loans consolidated</td>
</tr>
<tr class="even">
<td align="left">rehabilitation</td>
<td align="left">double</td>
<td align="left">Recoveries, Rehabilitation reflects the dollar value of loans rehabilitated</td>
</tr>
<tr class="odd">
<td align="left">voluntary_payments</td>
<td align="left">double</td>
<td align="left">Recoveries, Voluntary payments reflects the total amount of payments received from borrowers</td>
</tr>
<tr class="even">
<td align="left">wage_garnishments</td>
<td align="left">double</td>
<td align="left">Recoveries, Wage Garnishments reflect the total amount of wage garnishment payments</td>
</tr>
</tbody>
</table>
<p>Preview of the data:</p>
<pre class="r"><code>head(loans)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["agency_name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["year"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["quarter"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["starting"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["added"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["total"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["consolidation"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["rehabilitation"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["voluntary_payments"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["wage_garnishments"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"Account Control Technology, Inc.","2":"15","3":"4","4":"5807704381","5":"1040570567","6":"122602642","7":"20081894","8":"90952573","9":"5485507","10":"6082668"},{"1":"Allied Interstate, Inc.","2":"15","3":"4","4":"3693337631","5":"NA","6":"113326847","7":"11533809","8":"86967994","9":"4885225","10":"9939819"},{"1":"CBE Group","2":"15","3":"4","4":"2364391549","5":"NA","6":"83853003","7":"7377703","8":"64227391","9":"3939866","10":"8308043"},{"1":"Coast Professional, Inc.","2":"15","3":"4","4":"704216670","5":"NA","6":"99643903","7":"3401361","8":"85960328","9":"2509000","10":"7773214"},{"1":"Collection Technology Incorporated","2":"15","3":"4","4":"2952923197","5":"NA","6":"75725486","7":"8946976","8":"58395653","9":"2909013","10":"5473844"},{"1":"Collecto, INC dba EOS-CCA","2":"15","3":"4","4":"2296819928","5":"NA","6":"78776490","7":"6952382","8":"56324366","9":"3646365","10":"11853377"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>I noticed some names seemed to be duplicates, such as <code>Action Financial Services</code> and <code>Action Financial Services*</code> so I combined them. I tried to find a programatic way to find and replace, but it didn’t go well, then it stopped allowing me to knit the doc. So I ended up manually editing anyway. It also seems like <code>Account Control Technology, Inc.</code> is the same as <code>ACT</code>. The red rows are those tagged as duplicates, before and after cleaning.</p>
<pre class="r"><code># make it long
loans_long &lt;- pivot_longer(loans, 
                           cols = starting:wage_garnishments, 
                           names_to = &quot;type&quot;, 
                           values_to = &quot;amount&quot;) %&gt;% 
  mutate(year = year + 2000) %&gt;% 
  mutate(yrqtr = paste(year, &quot;Q&quot;, quarter)) %&gt;% 
  mutate(yrqtr = as.factor(yrqtr))

# fix dupe names
agency_names &lt;- sort(loans_long$agency_name) 

unique(agency_names) %&gt;% 
  data_frame() %&gt;% 
  rename(&quot;Raw agency names&quot; = &quot;.&quot;) %&gt;% 
  mutate(dupe_list = ifelse(`Raw agency names` %in% c(&quot;Account Control Technology, Inc.&quot;, &quot;ACT&quot;,
                                                      &quot;Action Financial Services*&quot;,
                                                          &quot;Action Financial Services&quot;,
                                                          &quot;Central Research*&quot;, &quot;Central Research&quot;,
                                                          &quot;Coast Professional Inc&quot;, &quot;Coast Professional, Inc.&quot;,
                                                          &quot;Credit Adjustments Inc&quot;, &quot;Credit Adjustments, Inc.&quot;,
                                                          &quot;Credit Adjustments, Inc.*&quot;, &quot;Credit Adjustments, Inc.&quot;,
                                                          &quot;FMS&quot;, &quot;FMS Investment Corp&quot;,
                                                          &quot;GC Services&quot;, &quot;GC Services LP&quot;,
                                                          &quot;Immediate Credit Recovery&quot;, &quot;Immediate Credit Recovery, Inc.&quot;,
                                                          &quot;National Recoveries Inc&quot;, &quot;National Recoveries, Inc.&quot;,
                                                          &quot;Pioneer&quot;, &quot;Pioneer Credit Recovery, Inc&quot;,
                                                          &quot;Windham&quot;, &quot;Windham Professionals, Inc.&quot;), 1, 0)) %&gt;%
  datatable() %&gt;% 
  formatStyle(columns = &quot;Raw agency names&quot;,
        valueColumns = &quot;dupe_list&quot;,
        color = styleEqual(&quot;1&quot;, &quot;red&quot;)
    )</code></pre>
<div id="htmlwidget-595c9d01f36ec5616628" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-595c9d01f36ec5616628">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42"],["Account Control Technology, Inc.","ACT","Action Financial Services","Action Financial Services*","Allied Interstate, Inc.","Bass and Associates","CBE Group","Central Research","Central Research*","Coast Professional Inc","Coast Professional, Inc.","Collection Technology Incorporated","Collecto, INC dba EOS-CCA","ConServe","Credit Adjustments Inc","Credit Adjustments, Inc.","Credit Adjustments, Inc.*","Delta Management Associates, Inc.","Diversified Collection Services, Inc.","ERS","FH Cann and Associates","Financial Asset Management Systems, Inc.","FMS","FMS Investment Corp","GC Services","GC Services LP","Immediate Credit Recovery","Immediate Credit Recovery, Inc.","National Credit Services","National Recoveries Inc","National Recoveries, Inc.","NCO Financial Systems, Inc.","Pioneer","Pioneer Credit Recovery, Inc","Premiere Credit of North America, LLC","Professional Bureau of Collections of Maryland","Progressive Financial Services, Inc.","Reliant Capital Solutions","Van Ru Credit Corporation","West Asset Management, Inc.","Windham","Windham Professionals, Inc."],[1,1,1,1,0,0,0,1,1,1,1,0,0,0,1,1,1,0,0,0,0,0,1,1,1,1,1,1,0,1,1,0,1,1,0,0,0,0,0,0,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Raw agency names<\/th>\n      <th>dupe_list<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nvar value=data[2]; $(this.api().cell(row, 1).node()).css({'color':value == '1' ? 'red' : ''});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
<pre class="r"><code># there are some repeats

##############################################
# super long-winded way to find them ... manual scan would have been quicker
# and now it won&#39;t knit :/

# fix &lt;- sapply(unique(agency_names), agrep, unique(agency_names), max.distance = 1, value = T)
# 
# fix_df &lt;- data.frame(unlist(fix))
# 
# fix_df$row_names &lt;- rownames(fix_df) 
# 
# dupes &lt;- substring(fix_df$row_names, nchar(names)) == &quot;2&quot;
# 
# filter &lt;- cbind(fix_df$row_names, dupes) %&gt;% data.frame() %&gt;% 
#   filter(., dupes == &quot;TRUE&quot;) 
# 
# fixes &lt;- inner_join(fix_df, filter, by = c(&quot;row_names&quot; = &quot;V1&quot;)) %&gt;% 
#   rename(., `new name` = unlist.fix., `old name` = row_names) %&gt;% 
#   select(-dupes)
# fixes$`old name` = substr(fixes$`old name`, 1, nchar(fixes$`old name`)-1)
# 
# # fixes &lt;- fixes %&gt;% filter(., !`old name` %in% c(&quot;Action Financial Services*&quot;, &quot;Central Research*&quot;, &quot;Credit Adjustments, Inc.*&quot;))
# # 
# # loans_long_fixed &lt;- left_join(loans_long, fixes, by = c(&quot;agency_name&quot; = &quot;new name&quot;))
##############################################

# fix &#39;em
loans_long$agency_name[which(loans_long$agency_name == &quot;ACT&quot;)] &lt;- &quot;Account Control Technology, Inc.&quot;
loans_long$agency_name[which(loans_long$agency_name == &quot;Action Financial Services*&quot;)] &lt;- &quot;Action Financial Services&quot;
loans_long$agency_name[which(loans_long$agency_name == &quot;Central Research*&quot;)] &lt;- &quot;Central Research&quot;
loans_long$agency_name[which(loans_long$agency_name == &quot;Coast Professional Inc&quot;)] &lt;- &quot;Coast Professional,  Inc.&quot;
loans_long$agency_name[which(loans_long$agency_name == &quot;Credit Adjustments Inc&quot;)] &lt;- &quot;Credit Adjustments, Inc.&quot;
loans_long$agency_name[which(loans_long$agency_name == &quot;Credit Adjustments, Inc.*&quot;)] &lt;- &quot;Credit Adjustments, Inc.&quot;
loans_long$agency_name[which(loans_long$agency_name == &quot;FMS&quot;)] &lt;- &quot;FMS Investment Corp&quot;
loans_long$agency_name[which(loans_long$agency_name == &quot;GC Services&quot;)] &lt;- &quot;GC Services LP&quot;
loans_long$agency_name[which(loans_long$agency_name == &quot;Immediate Credit Recovery&quot;)] &lt;- &quot;Immediate Credit Recovery, Inc.&quot;
loans_long$agency_name[which(loans_long$agency_name == &quot;National Recoveries Inc&quot;)] &lt;- &quot;National Recoveries, Inc.&quot;
loans_long$agency_name[which(loans_long$agency_name == &quot;Pioneer&quot;)] &lt;- &quot;Pioneer Credit Recovery, Inc&quot;
loans_long$agency_name[which(loans_long$agency_name == &quot;Windham&quot;)] &lt;- &quot;Windham Professionals, Inc.&quot;
loans_long$agency_name[which(loans_long$agency_name == &quot;Coast Professional,  Inc.&quot;)] &lt;- &quot;Coast Professional, Inc.&quot;

agency_names_fixed &lt;- sort(loans_long$agency_name) 

# look at &#39;em
unique(agency_names_fixed) %&gt;% 
  data_frame() %&gt;% 
  rename(&quot;Cleaned agency names&quot; = &quot;.&quot;) %&gt;% 
  mutate(dupe_list = ifelse(`Cleaned agency names` %in% c(&quot;Account Control Technology, Inc.&quot;, &quot;ACT&quot;,
                                                          &quot;Action Financial Services*&quot;,
                                                          &quot;Action Financial Services&quot;,
                                                          &quot;Central Research*&quot;, &quot;Central Research&quot;,
                                                          &quot;Coast Professional Inc&quot;, &quot;Coast Professional, Inc.&quot;,
                                                          &quot;Credit Adjustments Inc&quot;, &quot;Credit Adjustments, Inc.&quot;,
                                                          &quot;Credit Adjustments, Inc.*&quot;, &quot;Credit Adjustments, Inc.&quot;,
                                                          &quot;FMS&quot;, &quot;FMS Investment Corp&quot;,
                                                          &quot;GC Services&quot;, &quot;GC Services LP&quot;,
                                                          &quot;Immediate Credit Recovery&quot;, &quot;Immediate Credit Recovery, Inc.&quot;,
                                                          &quot;National Recoveries Inc&quot;, &quot;National Recoveries, Inc.&quot;,
                                                          &quot;Pioneer&quot;, &quot;Pioneer Credit Recovery, Inc&quot;,
                                                          &quot;Windham&quot;, &quot;Windham Professionals, Inc.&quot;), 1, 0)) %&gt;%
  DT::datatable() %&gt;% 
  DT::formatStyle(columns = &quot;Cleaned agency names&quot;,
        valueColumns = &quot;dupe_list&quot;,
        color = DT::styleEqual(&quot;1&quot;, &quot;red&quot;)
    )</code></pre>
<div id="htmlwidget-eae19a0a0f537154fd5a" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-eae19a0a0f537154fd5a">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"],["Account Control Technology, Inc.","Action Financial Services","Allied Interstate, Inc.","Bass and Associates","CBE Group","Central Research","Coast Professional, Inc.","Collection Technology Incorporated","Collecto, INC dba EOS-CCA","ConServe","Credit Adjustments, Inc.","Delta Management Associates, Inc.","Diversified Collection Services, Inc.","ERS","FH Cann and Associates","Financial Asset Management Systems, Inc.","FMS Investment Corp","GC Services LP","Immediate Credit Recovery, Inc.","National Credit Services","National Recoveries, Inc.","NCO Financial Systems, Inc.","Pioneer Credit Recovery, Inc","Premiere Credit of North America, LLC","Professional Bureau of Collections of Maryland","Progressive Financial Services, Inc.","Reliant Capital Solutions","Van Ru Credit Corporation","West Asset Management, Inc.","Windham Professionals, Inc."],[1,1,0,0,0,1,1,0,0,0,1,0,0,0,0,0,1,1,1,0,1,0,1,0,0,0,0,0,0,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Cleaned agency names<\/th>\n      <th>dupe_list<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nvar value=data[2]; $(this.api().cell(row, 1).node()).css({'color':value == '1' ? 'red' : ''});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
<p>I’m not really sure what the terms mean, so I just made some exploratory plots.</p>
<p>Rehabilitation was the greatest amount of the recoveries, about 75% of the total each year. Voluntary payments were pretty low, but got a slight bump in 2018.</p>
<p>Among inventory, starting amount was the greatest, which makes sense. There was a period in 2017 where no inventory was added. It looks like this corresponds to a slight increase in wage garnishments and decrease in consolidation. There’s a very large bump in inventory added in 2018, which looks like it corresponds to increase in rehabilitation and voluntary payments.</p>
<pre class="r"><code># area plot
# reorder
loans_long$type &lt;- factor(loans_long$type , levels=c(&quot;added&quot;, &quot;starting&quot;, &quot;total&quot;, &quot;rehabilitation&quot;, &quot;consolidation&quot;, &quot;wage_garnishments&quot;, &quot;voluntary_payments&quot;))

p1&lt;-loans_long %&gt;% 
  filter(!type %in% c(&quot;added&quot;, &quot;total&quot;, &quot;starting&quot;)) %&gt;%
  group_by(yrqtr, type) %&gt;% 
  summarize(sum = sum(amount, na.rm = T)) %&gt;% 
  mutate(percentage = sum / sum(sum, na.rm = T)) %&gt;% 
  ggplot(., aes(yrqtr, sum, fill = type)) + 
  geom_area(aes(group = type), position = &quot;stack&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  theme(legend.position = &quot;bottom&quot;)

p2&lt;-loans_long %&gt;% 
  filter(!type %in% c(&quot;added&quot;,&quot;total&quot;, &quot;starting&quot;)) %&gt;%
  group_by(yrqtr, type) %&gt;% 
  summarize(sum = sum(amount, na.rm = T)) %&gt;% 
  mutate(percentage = sum / sum(sum, na.rm = T)) %&gt;% 
  ggplot(., aes(yrqtr, percentage, fill = type)) + 
  geom_area(aes(group = type), position = &quot;stack&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  theme(legend.position = &quot;none&quot;)

ggarrange(p1, p2, 
          ncol = 2, common.legend = TRUE, legend = &quot;bottom&quot;)</code></pre>
<p><img src="TT_2019_48_files/figure-html/area_plots-1.png" width="672" /></p>
<pre class="r"><code>p3 &lt;- loans_long %&gt;% 
  filter(type %in% c(&quot;added&quot;, &quot;starting&quot;)) %&gt;%
  group_by(yrqtr, type) %&gt;%
  summarize(sum = sum(amount, na.rm = T)) %&gt;%
  mutate(percentage = sum / sum(sum)) %&gt;%
  ggplot(., aes(yrqtr, sum, fill = type)) +
  geom_area(aes(group = type), position = &quot;stack&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  theme(legend.position = &quot;bottom&quot;)
 
p4 &lt;-  loans_long %&gt;% 
  filter(type %in% c(&quot;added&quot;, &quot;starting&quot;)) %&gt;%
  group_by(yrqtr, type) %&gt;%
  summarize(sum = sum(amount, na.rm = T)) %&gt;%
  mutate(percentage = sum / sum(sum)) %&gt;%
  ggplot(., aes(yrqtr, percentage, fill = type)) +
  geom_area(aes(group = type), position = &quot;stack&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  theme(legend.position = &quot;none&quot;)
  
ggarrange(p3, p4, 
          ncol = 2, common.legend = TRUE, legend = &quot;bottom&quot;)</code></pre>
<p><img src="TT_2019_48_files/figure-html/area_plots-2.png" width="672" /></p>
<pre class="r"><code>#unique(loans_long$yrqtr)

box_plot_2015 &lt;- loans_long %&gt;% 
  filter(!type %in% c(&quot;added&quot;, &quot;total&quot;, &quot;starting&quot;)) %&gt;%
  filter(year == 2015) %&gt;% 
  ggplot(., aes(yrqtr, amount, fill = type)) + 
  geom_boxplot()

box_plot_2016 &lt;- loans_long %&gt;% 
  filter(!type %in% c(&quot;added&quot;, &quot;total&quot;, &quot;starting&quot;)) %&gt;%
  filter(year == 2016) %&gt;% 
  ggplot(., aes(yrqtr, amount, fill = type)) + 
  geom_boxplot()

box_plot_2017 &lt;- loans_long %&gt;% 
  filter(!type %in% c(&quot;added&quot;, &quot;total&quot;, &quot;starting&quot;)) %&gt;%
  filter(year == 2017) %&gt;% 
  ggplot(., aes(yrqtr, amount, fill = type)) + 
  geom_boxplot()

box_plot_2018 &lt;- loans_long %&gt;% 
  filter(!type %in% c(&quot;added&quot;, &quot;total&quot;, &quot;starting&quot;)) %&gt;%
  filter(year == 2018) %&gt;% 
  ggplot(., aes(yrqtr, amount, fill = type)) + 
  geom_boxplot()

ggarrange(box_plot_2015, box_plot_2016, box_plot_2017, box_plot_2018, 
          ncol = 2, nrow = 2, common.legend = TRUE, legend = &quot;bottom&quot;)</code></pre>
<p><img src="TT_2019_48_files/figure-html/plots-1.png" width="672" /></p>
<p>Below are spagetti plots by each agency, animated using <code>gganimate</code></p>
<p>There seems to be a lot of NA’s in the plots. It looks like some data is missing entirely for some years, or there are gaps in some agencies’ data. Not sure why, and it would probably take some digging in to the companies and other data sources to try to figure it out. It looks like some of the agencies that go missing were trending down prior to that - so maybe they closed or went out of business.</p>
<pre class="r"><code>spag_plot &lt;- loans_long %&gt;% 
  filter(!type %in% c(&quot;total&quot;)) %&gt;% 
  ggplot(., aes(yrqtr, amount, color = type, group = agency_name)) + 
  geom_line() +
  facet_grid(type~., scales = &quot;free_y&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  theme(legend.position = &quot;bottom&quot;) +
  transition_reveal(as.numeric((yrqtr))) +
  ease_aes(&#39;linear&#39;)

animate(spag_plot)</code></pre>
<p><img src="TT_2019_48_files/figure-html/plots_2-1.gif" /><!-- --></p>
<pre class="r"><code># loans_long %&gt;% filter(is.na(amount)) %&gt;%  knitr::kable()</code></pre>
<hr />
<P ALIGN="CENTER">
<a href="https://github.com/k-maciejewski/TidyTuesdays"><i class="fa fa-github" font color="#4F8AC2" style="font-size: 20pt"></i></a> <a href="https://k-maciejewski.github.io"><i class="fa fa-globe" font color="#4F8AC2" style="font-size: 20pt"></i></a>
</P>
<hr />




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
